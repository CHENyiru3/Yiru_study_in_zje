
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://CHENyiru3.github.io/Yiru_study_in_zje/IBMS3_full/Yiru/detailed/experiments_case/S2W4%20Survival%20Analysis/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Kaplan-Meier估计与Log-rank检验的数学原理与应用 - ZJE Collection</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kaplan-meierlog-rank" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="ZJE Collection" class="md-header__button md-logo" aria-label="ZJE Collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZJE Collection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kaplan-Meier估计与Log-rank检验的数学原理与应用
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="ZJE Collection" class="md-nav__button md-logo" aria-label="ZJE Collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ZJE Collection
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Courses
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Courses
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../BG2_sum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BG2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../GP2_sum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GP2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IBMS3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MBE3_sum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MBE3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../PoN3_full/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PoN3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../IID_4_full/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IID_4
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../IFBS2_full/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IFBS2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../IN_full/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../BaO2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BaO2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MI2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MI2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributors
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../AUTHORS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../ZIPS_INDEX/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zips Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kaplan-meier" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、Kaplan-Meier估计的数学基础
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、Kaplan-Meier估计的数学基础">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 基本原理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 数学推导
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 方差估计与置信区间
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 中位生存时间
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaplan-meier_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、Kaplan-Meier曲线的解释与特性
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、Kaplan-Meier曲线的解释与特性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 曲线特性
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 审查标记
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 风险表
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-rank" class="md-nav__link">
    <span class="md-ellipsis">
      
        三、Log-rank检验的统计学原理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、Log-rank检验的统计学原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 基本假设与思想
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 数学构造
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 检验统计量构造
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-p" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. p值解释
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-rank_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        四、Log-rank检验的变体与扩展
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、Log-rank检验的变体与扩展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-log-rank" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 加权Log-rank检验
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-log-rank" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 分层Log-rank检验
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaplan-meierlog-rank_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        五、Kaplan-Meier曲线与Log-rank检验的应用考量
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、Kaplan-Meier曲线与Log-rank检验的应用考量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 样本量与统计检验力
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 假设验证
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 解释陷阱与注意事项
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="kaplan-meierlog-rank">Kaplan-Meier估计与Log-rank检验的数学原理与应用<a class="headerlink" href="#kaplan-meierlog-rank" title="Permanent link">&para;</a></h1>
<h2 id="kaplan-meier">一、Kaplan-Meier估计的数学基础<a class="headerlink" href="#kaplan-meier" title="Permanent link">&para;</a></h2>
<h3 id="1">1. 基本原理<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>Kaplan-Meier估计器是一种非参数方法，用于估计存在右审查数据时的生存函数。其核心思想是将生存概率表示为一系列条件概率的乘积。</p>
<p>生存函数S(t)的定义为在时间t之后仍未发生事件的概率：</p>
<pre><code>S(t) = P(T &gt; t)
</code></pre>
<p>其中T是事件发生的时间。</p>
<h3 id="2">2. 数学推导<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>假设我们有观察到的事件发生时间t₁ &lt; t₂ &lt; ... &lt; tₖ，Kaplan-Meier估计器通过以下步骤构建：</p>
<ol>
<li>
<p><strong>条件概率分解</strong>：
   生存函数可以表示为连续条件概率的乘积：
   <code>S(t) = P(T &gt; t₁) × P(T &gt; t₂|T &gt; t₁) × ... × P(T &gt; t|T &gt; tⱼ)</code>
   其中tⱼ是小于t的最大观察时间点。</p>
</li>
<li>
<p><strong>条件概率估计</strong>：
   在每个时间点tᵢ，我们估计条件概率：
   <code>P(T &gt; tᵢ|T &gt; tᵢ₋₁) = 1 - dᵢ/nᵢ</code>
   其中：</p>
</li>
<li>dᵢ = 在时间tᵢ发生事件的数量</li>
<li>
<p>nᵢ = 在时间tᵢ处于"风险集"中的对象数量（即在tᵢ之前既没有发生事件也没有被审查的对象）</p>
</li>
<li>
<p><strong>乘积极限估计器</strong>：
   Kaplan-Meier估计器的最终形式为：
   <code>Ŝ(t) = ∏ₖ:ₜₖ≤ₜ (1 - dₖ/nₖ)</code>
   这是一个阶梯函数，在每个事件发生时间点处下降，在审查时间点保持不变。</p>
</li>
</ol>
<h3 id="3">3. 方差估计与置信区间<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>Kaplan-Meier估计器的方差通常使用Greenwood公式估计：</p>
<pre><code>Var[Ŝ(t)] = [Ŝ(t)]² × ∑ₖ:ₜₖ≤ₜ [dₖ/(nₖ×(nₖ-dₖ))]
</code></pre>
<p>95%置信区间可以通过多种方法构建：</p>
<ol>
<li>
<p><strong>线性近似</strong>：
   <code>Ŝ(t) ± 1.96 × √Var[Ŝ(t)]</code></p>
</li>
<li>
<p><strong>对数变换</strong>（更常用）：
   <code>Ŝ(t)^exp(±1.96×σ/[Ŝ(t)×log(Ŝ(t))])</code>
   其中σ是Ŝ(t)的标准误。</p>
</li>
<li>
<p><strong>log-log变换</strong>：
   基于log(-log(Ŝ(t)))的渐近正态性，提供更好的覆盖概率。</p>
</li>
</ol>
<h3 id="4">4. 中位生存时间<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p>中位生存时间是使S(t) = 0.5的时间t，即：</p>
<pre><code>tₘₑₐₙ = min{t: Ŝ(t) ≤ 0.5}
</code></pre>
<p>当生存曲线未降至0.5以下时，中位生存时间不可估计。</p>
<h2 id="kaplan-meier_1">二、Kaplan-Meier曲线的解释与特性<a class="headerlink" href="#kaplan-meier_1" title="Permanent link">&para;</a></h2>
<h3 id="1_1">1. 曲线特性<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>阶梯函数</strong>：曲线在事件发生时下降，在审查时不变</li>
<li><strong>初始值</strong>：S(0) = 1（假设所有对象在研究开始时都未发生事件）</li>
<li><strong>终值</strong>：如果最后的观察是事件而非审查，则曲线可能降至0；如果最后的观察是审查，则曲线不会达到0</li>
<li><strong>平台期</strong>：曲线中的水平段表示该时间段内未观察到事件</li>
<li><strong>陡降</strong>：曲线急剧下降表示事件密集发生</li>
</ul>
<h3 id="2_1">2. 审查标记<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h3>
<p>Kaplan-Meier曲线上通常用特殊符号（如"+"或短垂线）标记审查点，这些标记提供了关于数据完整性的重要信息：</p>
<ul>
<li>审查标记的分布表明研究的随访模式</li>
<li>曲线末端大量审查标记提示随访时间可能不足</li>
<li>不同组别审查模式的差异可能暗示潜在偏倚</li>
</ul>
<h3 id="3_1">3. 风险表<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h3>
<p>Kaplan-Meier图下方通常附有"风险表"(risk table)，显示各时间点仍处于风险中的对象数量：</p>
<pre><code>Time:    0    6    12   18   24   30
At risk: 100  87   75   54   32   15
</code></pre>
<p>风险表提供了重要上下文信息：
- 显示样本量随时间减少
- 帮助解释曲线末端的不确定性增加
- 在比较多组时尤为重要，表明各时间点的组间样本量平衡情况</p>
<h2 id="log-rank">三、Log-rank检验的统计学原理<a class="headerlink" href="#log-rank" title="Permanent link">&para;</a></h2>
<h3 id="1_2">1. 基本假设与思想<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h3>
<p>Log-rank检验是比较两个或多个生存曲线的非参数方法，基于以下假设：</p>
<ul>
<li><strong>零假设(H₀)</strong>：各组的生存函数相同，即S₁(t) = S₂(t) = ... = Sₖ(t)</li>
<li><strong>替代假设(H₁)</strong>：至少有一组的生存函数与其他组不同</li>
</ul>
<p>检验的核心思想是：如果零假设为真，则各组在每个时间点观察到的事件数应与期望事件数接近。</p>
<h3 id="2_2">2. 数学构造<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h3>
<p>考虑在每个观察到事件的时间点tᵢ，构建如下2×2表（以两组比较为例）：</p>
<pre><code>          事件    无事件    风险集
组1        O₁ᵢ    n₁ᵢ-O₁ᵢ    n₁ᵢ
组2        O₂ᵢ    n₂ᵢ-O₂ᵢ    n₂ᵢ
总计       dᵢ      nᵢ-dᵢ     nᵢ
</code></pre>
<p>其中：
- O₁ᵢ, O₂ᵢ = 各组在时间tᵢ观察到的事件数
- n₁ᵢ, n₂ᵢ = 各组在时间tᵢ的风险集大小
- dᵢ = 在时间tᵢ发生的总事件数
- nᵢ = 在时间tᵢ的总风险集大小</p>
<p>在零假设下，O₁ᵢ近似服从超几何分布，其期望值为：</p>
<pre><code>E₁ᵢ = n₁ᵢ × (dᵢ/nᵢ)
</code></pre>
<p>方差为：</p>
<pre><code>V₁ᵢ = n₁ᵢ × n₂ᵢ × dᵢ × (nᵢ-dᵢ) / [nᵢ² × (nᵢ-1)]
</code></pre>
<h3 id="3_2">3. 检验统计量构造<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h3>
<p>Log-rank检验统计量通过汇总所有时间点的观察值与期望值之差：</p>
<ol>
<li>
<p><strong>对每个组j计算</strong>：
   <code>Oⱼ = ∑ᵢOⱼᵢ （总观察事件数）
   Eⱼ = ∑ᵢEⱼᵢ （总期望事件数）</code></p>
</li>
<li>
<p><strong>构造检验统计量</strong>：
   对于两组比较：
   <code>χ² = (O₁-E₁)² / Var(O₁-E₁)</code>
   其中Var(O₁-E₁) = ∑ᵢV₁ᵢ</p>
</li>
</ol>
<p>对于多组比较（k组）：
   <code>χ² = U'V⁻¹U</code>
   其中U是长度为(k-1)的向量，元素为Oⱼ-Eⱼ，V是(k-1)×(k-1)的协方差矩阵。</p>
<ol>
<li><strong>分布</strong>：
   在零假设下，χ²统计量近似服从自由度为(组数-1)的卡方分布。</li>
</ol>
<h3 id="4-p">4. p值解释<a class="headerlink" href="#4-p" title="Permanent link">&para;</a></h3>
<p>Log-rank检验的p值表示在零假设为真的条件下，观察到当前或更极端差异的概率：</p>
<ul>
<li>p &lt; 0.05：通常认为存在统计学显著差异，拒绝零假设</li>
<li>p值越小，证据越强烈支持组间生存曲线存在差异</li>
<li>p值不能告诉我们差异的大小或临床意义</li>
</ul>
<h2 id="log-rank_1">四、Log-rank检验的变体与扩展<a class="headerlink" href="#log-rank_1" title="Permanent link">&para;</a></h2>
<h3 id="1-log-rank">1. 加权Log-rank检验<a class="headerlink" href="#1-log-rank" title="Permanent link">&para;</a></h3>
<p>标准Log-rank检验对所有时间点赋予相同权重，但在某些情况下，我们可能希望强调特定时间段的差异。加权Log-rank检验通过引入权重函数W(t)实现这一目的：</p>
<pre><code>χ²_w = [∑ᵢW(tᵢ)(O₁ᵢ-E₁ᵢ)]² / ∑ᵢW(tᵢ)²V₁ᵢ
</code></pre>
<p>常见的加权版本包括：</p>
<ol>
<li><strong>Gehan-Breslow-Wilcoxon检验</strong>：</li>
<li>权重W(t) = nᵢ（风险集大小）</li>
<li>强调早期差异</li>
<li>
<p>当审查模式不同时更稳健</p>
</li>
<li>
<p><strong>Peto-Peto检验</strong>：</p>
</li>
<li>权重W(t) = S̃(t)，其中S̃(t)是修改的Kaplan-Meier估计</li>
<li>对晚期事件较少依赖</li>
<li>
<p>对不同审查模式更稳健</p>
</li>
<li>
<p><strong>Fleming-Harrington检验</strong>：</p>
</li>
<li>权重W(t) = [Ŝ(t)]ᵖ[1-Ŝ(t)]ᵍ</li>
<li>参数p,q可调整，强调早期(p&gt;0,q=0)或晚期(p=0,q&gt;0)差异</li>
<li>灵活性高，适用于特定研究问题</li>
</ol>
<h3 id="2-log-rank">2. 分层Log-rank检验<a class="headerlink" href="#2-log-rank" title="Permanent link">&para;</a></h3>
<p>当存在可能影响生存的混杂因素时，分层Log-rank检验允许在控制这些因素的同时比较主要分组因素的效应：</p>
<ol>
<li><strong>方法</strong>：</li>
<li>在每个分层水平内分别计算观察值与期望值</li>
<li>
<p>汇总所有分层的结果</p>
</li>
<li>
<p><strong>统计量</strong>：
   <code>χ²_stratified = [∑ₛ∑ᵢ(O₁ᵢₛ-E₁ᵢₛ)]² / ∑ₛ∑ᵢV₁ᵢₛ</code>
   其中s表示分层水平。</p>
</li>
<li>
<p><strong>应用场景</strong>：</p>
</li>
<li>多中心临床试验（按中心分层）</li>
<li>存在已知预后因素（如疾病分期）时</li>
</ol>
<h2 id="kaplan-meierlog-rank_1">五、Kaplan-Meier曲线与Log-rank检验的应用考量<a class="headerlink" href="#kaplan-meierlog-rank_1" title="Permanent link">&para;</a></h2>
<h3 id="1_3">1. 样本量与统计检验力<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h3>
<p>Log-rank检验的检验力取决于：
- 事件总数（通常比总样本量更重要）
- 预期的效应大小（风险比）
- 显著性水平（通常为0.05）</p>
<p>样本量计算公式：</p>
<pre><code>所需事件数 = 4 × (z_α/2 + z_β)² / [log(HR)]²
</code></pre>
<p>其中:
- z_α/2 = 显著性水平对应的z值（1.96对应α=0.05）
- z_β = 检验力对应的z值（0.84对应80%检验力）
- HR = 预期风险比</p>
<h3 id="2_3">2. 假设验证<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h3>
<p>Log-rank检验基于以下假设：
- <strong>比例风险假设</strong>：各组的风险函数之比随时间保持恒定
- <strong>独立审查假设</strong>：审查机制与事件发生机制相互独立
- <strong>组间独立性</strong>：不同组别的观察相互独立</p>
<p>验证方法：
- 绘制log(-log(S(t)))对log(t)的图，检查曲线平行性
- 检查审查模式在各组间的分布
- 评估时间依赖效应</p>
<h3 id="3_3">3. 解释陷阱与注意事项<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>审查处理</strong>：</li>
<li>审查数据不是"缺失数据"，而是包含部分信息</li>
<li>
<p>忽略审查或将审查视为事件都会导致严重偏倚</p>
</li>
<li>
<p><strong>交叉生存曲线</strong>：</p>
</li>
<li>当生存曲线交叉时，Log-rank检验可能无法检测到差异</li>
<li>交叉曲线暗示违反比例风险假设</li>
<li>
<p>考虑使用加权Log-rank检验或分段分析</p>
</li>
<li>
<p><strong>长尾效应</strong>：</p>
</li>
<li>曲线末端基于很少的风险集，估计不确定性大</li>
<li>末端的看似显著差异可能仅基于几个事件</li>
<li>
<p>关注风险表和置信区间宽度</p>
</li>
<li>
<p><strong>多重比较</strong>：</p>
</li>
<li>比较多组时需要考虑多重检验校正</li>
<li>
<p>常用方法：Bonferroni校正、Holm方法、Hochberg方法</p>
</li>
<li>
<p><strong>临床相关性</strong>：</p>
</li>
<li>统计显著性不等同于临床意义</li>
<li>评估绝对差异（如5年生存率差异）和中位生存时间差异</li>
<li>考
<img alt="" src="https://i.imgur.com/oflKVJi.png" /></li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": [], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>